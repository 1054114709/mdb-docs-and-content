<!--Section: Doc content-->
<section class="documentation">

    <!--Section: Intro-->
    <section id="introduction">

        <!--Title-->
        <h1 class="main-title">角度通用</h1>

        <!--Description-->
        <div class="description">
            <p>Angular Universal也称为服务器端渲染，它是允许用户在用户首次访问您的网站时预渲染Angular应用程序的工具。</p>

            <p>服务器端渲染对于Web应用的SEO，性能和可访问性具有很多好处！</p>

            <p>在本指南中，我们将向您展示如何与MDB Angular和Express.js服务器一起实现Angular Universal！</p>
        </div>

    </section>

    <section>

        <h4><b>步骤1： </b>安装服务器依赖项</h4>
        <p class="description">
            我们必须安装一些其他依赖项才能使用Angular Universal。在控制台中输入：
<pre class="code-toolbar"><code class="language-javascript">npm install @ angular / platform-server express --save npm install ts-loader webpack-node-externals npm-run-all --save-dev</code></pre>
        </p>
        <br>

        <h4><b>第2步： </b>创建ServerModule文件</h4>
        <p class="description">
            我们必须在以下路径中创建app.server.module.ts文件：src / app / app.server.module.ts，然后在其中粘贴代码：
<pre class="code-toolbar"><code class="language-javascript">
从“ @ angular / core”导入{NgModule}；从“ @ angular / platform-server”导入{ServerModule}；从&amp;#39;./app.module&amp;#39;导入{AppModule};从“ ./app.component”导入{AppComponent}； @NgModule（{导入：[AppModule，ServerModule]，引导程序：[AppComponent]，}）导出类AppServerModule {}
</code></pre>
        </p>
        <br>

        <h4><b>第三步： </b>更新app.module.file</h4>
        <p class="description">
            进入src / app / app.module.ts文件，并在下面的代码中添加到导入表：
<pre class="code-toolbar"><code class="language-javascript">
进口：[...
    BrowserModule.withServerTransition（{appId：&amp;#39;place-here-your-app-name&amp;#39;}），...
  ],
</code></pre>
        </p>
        <br>

        <h4><b>步骤4： </b>创建main.server.ts文件</h4>
        <p class="description">
            在src目录中，创建一个名为main.server.ts的新文件，并将其放在下面的代码中：
<pre class="code-toolbar"><code class="language-javascript">
从&amp;#39;./app/app.server.module&amp;#39;导出{AppServerModule};
</code></pre>
        </p>
        <br>

        <h4><b>步骤5： </b>更新您的angular-cli.json文件</h4>
        <p class="description">
            在src目录中，创建一个名为main.server.ts的新文件，并将其放在下面的代码中：
<pre class="code-toolbar"><code class="language-javascript">
{“ $ schema”：“ ./node_modules/@angular/cli/lib/config/schema.json”，“项目”：{“名称”：“ pro523”}，“应用程序”：[{“ root”：“ src”，“ outDir”：“ dist /浏览器”，“资产”：[“资产”，“ favicon.ico”]，“ index”：“ index.html”，“ main”：“ main.ts”，“ polyfills”：“ polyfills.ts”，“ test”：“ test.ts”，“ tsconfig”：“ tsconfig.app.json”，“ testTsconfig”：“ tsconfig.spec.json”，“ prefix”：“ app” ，“样式”：[“ ../node_modules/font-awesome/scss/font-awesome.scss&amp;quot;、&amp;quot;../node_modules/ng-mdb-pro/assets/scss/bootstrap/bootstrap.scss”，“。./node_modules/ng-mdb-pro/assets/scss/mdb.scss&amp;quot;、&amp;quot;./styles.scss“]，”脚本“：[” ../node_modules/chart.js/dist/Chart.js“，“ ../node_modules/easy-pie-chart/dist/easypiechart.js”，“ ../node_modules/screenfull/dist/screenfull.js”，“ ../node_modules/hammerjs/hammer.min.js”]，“ environmentSource”：“ environments / environment.ts”，“ environments”：{“ dev”：“ environments / environment.ts”，“ prod”：“ environments / environment.prod.ts”}}，{“平台”： “服务器”，“根”：“ src”，“ outDir”：“ dist / server”，“ ass ets“：[]，” index“：” index.html“，” main“：” main.server.ts“，” test“：” test.ts“，” tsconfig“：” tsconfig.server.json“，“ testTsconfig”：“ tsconfig.spec.json”，“ prefix”：“ app”，“ styles”：[“ ../node_modules/font-awesome/scss/font-awesome.scss”，“ ../node_modules/ ng-mdb-pro / assets / scss / bootstrap / bootstrap.scss“，” ../ node_modules / ng-mdb-pro / assets / scss / mdb.scss“，” ./ styles.scss“]，”脚本“ ：[[../node_modules/chart.js/dist/Chart.js“，” ../node_modules/easy-pie-chart/dist/easypiechart.js“，” ../node_modules/screenfull/dist/screenfull。js”，“ ../ node_modules / hammerjs / hammer.min.js”]，“ environmentSource”：“ environments / environment.ts”，“ environments”：{“ dev”：“ environments / environment.ts”，“ prod “：”“ environments / environment.prod.ts”}}]，“ e2e”：{“ protractor”：{“ config”：“ ./protractor.conf.js”}}，“ lint”：[{ ：“” src / tsconfig.app.json“，” exclude“：” ** / node_modules / **“}，{” project“：” src / tsconfig.spec.json“，” exclude“：” ** / node_modules / **“}，{”项目“：” e2e / tsconfig.e2e.json“，”排除“ ：“ ** / node_modules / **”}]，“ test”：{“ karma”：{“ config”：“ ./karma.conf.js”}}，“ defaults”：{“ styleExt”：“ scss “，“零件”： {} } }
</code></pre>
        </p>
        <br>

        <h4><b>步骤6： </b>创建tsconfig.server.json文件</h4>
        <p class="description">
            在src目录中，创建一个名为tsconfig.server.json的新文件，并将其放在下面的代码中：
<pre class="code-toolbar"><code class="language-javascript">
{“扩展”：“ ../tsconfig.json”，“ compilerOptions”：{“ outDir”：“ ../out-tsc/app”，“ baseUrl”：“ ./”，“ module”：“ commonjs” ，“ types”：[]}，“ exclude”：[“ test.ts”，“ ** / *。spec.ts”，“ server.ts”]，“ include”：[“ node_modules / ng-mdb- pro / ** / *。ts“，” / ** / *。ts“]，” angularCompilerOptions“：{” entryModule“：” app / app.server.module＃AppServerModule“}}
</code></pre>
        </p>
        <br>

        <h4><b>步骤7： </b>更新tsconfig.app.json文件</h4>
        <p class="description">
            进入您的src / tsconfig.app.json文件，并使用以下代码对其进行更新：
<pre class="code-toolbar"><code class="language-javascript">
{“扩展”：“ ../tsconfig.json”，“ compilerOptions”：{“ outDir”：“ ../out-tsc/app”，“ baseUrl”：“ ./”，“ module”：“ es2015” ，“ types”：[]}，“ exclude”：[“ test.ts”，“ ** / *。spec.ts”，“ server.ts”]}
</code></pre>
        </p>
        <br>

        <h4><b>步骤8： </b>检查应用程序是否正确构建</h4>
        <p class="description">
            在终端中键入以下命令，以检查您的应用程序是否正确构建
<pre class="code-toolbar"><code class="language-javascript">
ng build -prod --build-optimizer --app 0 ng build --aot --app 1
</code></pre>
        </p>
        <br>

        <h4><b>步骤9： </b>创建server.ts文件以使用Express.js</h4>
        <p class="description">
            进入src目录，并在其中创建server.ts文件，并使用以下代码填充它：
<pre class="code-toolbar"><code class="language-javascript">
导入“ reflect-metadata”；导入&amp;#39;zone.js / dist / zone-node&amp;#39;;从&amp;#39;@ angular / platform-server&amp;#39;导入{renderModuleFactory};从&amp;#39;@ angular / core&amp;#39;导入{enableProdMode};从* express进口*作为快递；从“路径”导入{join}；从“ fs”导入{readFileSync}； enableProdMode（）; const domino = require（&amp;#39;domino&amp;#39;）; const DIST_FOLDER = join（process.cwd（），&amp;#39;dist&amp;#39;）; const templatee = readFileSync（join（DIST_FOLDER，&amp;#39;browser&amp;#39;，&amp;#39;index.html&amp;#39;））。toString（）; const win = domino.createWindow（templatee）; global [&amp;#39;window&amp;#39;] =赢； global [&amp;#39;document&amp;#39;] = win.document; const PORT = process.env.PORT || 4200; const app = express（）; const template = readFileSync（join（DIST_FOLDER，&amp;#39;browser&amp;#39;，&amp;#39;index.html&amp;#39;））。toString（）; const {AppServerModuleNgFactory} = require（&amp;#39;main.server&amp;#39;）; app.engine（&amp;#39;html&amp;#39;，（_，options，callback）=> {const opts = {document：template，url：options.req.url}; renderModuleFactory（AppServerModuleNgFactory，opts）.then（html => callback（null ，html））;}）; app.set（&amp;#39;view engine&amp;#39;，&amp;#39;html&amp;#39;）; app.set（&amp;#39;views&amp;#39;，&amp;#39;src&amp;#39;）; app.get（&amp;#39;*。*&amp;#39;，express.static（join（DIST_FOLDER，&amp;#39;浏览器&amp;#39;）））; app.get（&amp;#39;*&amp;#39;，（req，res）=> {res.render（&amp;#39;index&amp;#39;，{req}）;}）; app.listen（PORT，（）=> {console.log（`在http：// localhost：$ {PORT}上监听！10
</code></pre>
        </p>
        <br>

        <h4><b>步骤10： </b>创建webpack.config.js文件</h4>
        <p class="description">
            在应用程序的根（主）目录中，创建名为webpack.config.js的文件，并使用以下代码填充该文件：
<pre class="code-toolbar"><code class="language-javascript">
const path = require（&amp;#39;path&amp;#39;）; var nodeExternals = require（&amp;#39;webpack-node-externals&amp;#39;）; module.exports = {条目：{服务器：&amp;#39;./src/server.ts&amp;#39;}，解析：{扩展名：[&amp;#39;.ts&amp;#39;，&amp;#39;.js&amp;#39;]，别名：{&amp;#39;main.server&amp;#39;：path.join （__dirname，&amp;#39;dist&amp;#39;，&amp;#39;server&amp;#39;，&amp;#39;main.bundle.js&amp;#39;）}}，目标：&amp;#39;node&amp;#39;，外部对象：[nodeExternals（{白名单：[/ ^ @ agm \ / core /，/ ^ hammerjs / ]}）]，输出：{路径：path.join（__ dirname，&amp;#39;dist&amp;#39;），文件名：&amp;#39;[name] .js&amp;#39;}，模块：{规则：[{测试：/\.ts$/，装载程序： &amp;#39;ts-loader&amp;#39;}]}}
</code></pre>
        </p>
        <br>

        <h4><b>步骤11： </b>将构建脚本添加到package.json文件</h4>
        <p class="description">
            进入您的package.json文件，并放置构建脚本：
<pre class="code-toolbar"><code class="language-javascript">
{“ name”：“ pro523”，“ version”：“ 0.0.0”，“ license”：“ MIT”，“ scripts”：{“ ng”：“ ng”，“ start”：“ ng serve”，“ build“：”运行中的build：client build：aot build：server“，” build：client“：” ng build -prod --build-optimizer --app 0“，” build：aot“：” ng build- -aot --app 1“，” build：server“：” webpack -p“，” test“：” ng test“，” lint“：” ng lint“，” e2e“：” ng e2e“}，”私有“：true，”依赖关系“：{” @ angular / animations“：” ^ 5.2.0“，” @ angular / common“：” ^ 5.2.0“，” @ angular / compiler“：” ^ 5.2.0“ ，“ @ angular / core”：“ ^ 5.2.0”，“ @ angular / forms”：“ ^ 5.2.0”，“ @ angular / http”：“ ^ 5.2.0”，“ @ angular / platform-browser “：” ^ 5.2.0“，” @ angular / platform-browser-dynamic“：” ^ 5.2.0“，” @ angular / platform-server“：” ^ 5.2.9“，” @ angular / router“： “ ^ 5.2.0”，“ chart.js”：“ ^ 2.5.0”，“ core-js”：“ ^ 2.4.1”，“ easy-pie-chart”：“ ^ 2.1.7”，“表达“：” ^ 4.16.3“，” font-awesome“：” ^ 4.7.0“，” hammerjs“：” ^ 2.0.8“，” ng-mdb-pro“：” git + https：// &lt;your-token> @ git.mdbootstrap.com / mdb / angular / ng-pro.git“，” rxjs“：” ^ 5.5.6“，” screenfull“：” ^ 3.3.0“，” zone.js“：” ^ 0.8。19“}，” devDependencies“：{” @ angular / cli“：” 1.6.5“，” @ angular / compiler-cli“：” ^ 5.2.0“，” @ angular / language-service“：” ^ 5.2 .0“，” @ types / jasmine“：”〜2.8.3“，” @ types / jasminewd2“：”〜2.0.2“，” @ types / node“：”〜6.0.60“，” codelyzer“： “ ^ 4.0.1”，“茉莉花芯”：“〜2.8.0”，“茉莉花规格报告”：“〜4.2.1”，“业力”：“〜2.0.0”，“业力铬-launcher”：“〜2.2.0”，“ karma-cli”：“〜1.0.1”，“ karma-coverage-istanbul-reporter”：“ ^ 1.2.1”，“ karma-jasmine”：“〜1.1 .0”，“ karma-jasmine-html-reporter”：“ ^ 0.2.2”，“ npm-run-all”：“ ^ 4.1.2”，“量角器”：“〜5.1.2”，“ ts- loader“：” ^ 3.5.0“，” ts-node“：”〜4.1.0“，” tslint“：”〜5.9.1“，” typescript“：”〜2.5.3“，” webpack-node-外部”：“ ^ 1.6.0”}}
</code></pre>
        </p>
        <br>

        <h4><b>步骤12： </b>更新您的src / main.ts文件</h4>
        <p class="description">
            进入src目录，并更新main.ts文件：
<pre class="code-toolbar"><code class="language-javascript">
从&amp;#39;@ angular / core&amp;#39;导入{enableProdMode};从&amp;#39;@ angular / platform-browser-dynamic&amp;#39;导入{platformBrowserDynamic};从&amp;#39;./app/app.module&amp;#39;导入{AppModule};从&amp;#39;./environments/environment&amp;#39;导入{环境}；如果（environment.production）{enableProdMode（）; } document.addEventListener（&amp;#39;DOMContentLoaded&amp;#39;，（）=> {platformBrowserDynamic（）。bootstrapModule（AppModule）.catch（err => console.log（err））;}）;
</code></pre>
        </p>
        <br>

        <h4><b>步骤13： </b>探索您的应用程序！</h4>
        <p class="description">
            在终端中放入最后一个命令，并探索Angular Universal应用程序！<pre class="code-toolbar"><code class="language-javascript">
npm运行build &amp;&amp;节点dist / server.js
</code></pre>
        </p>
        <br>

    </section>

</section>
<!--/Section: Doc content-->
